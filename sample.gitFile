heheh refactored everything through noptepad
